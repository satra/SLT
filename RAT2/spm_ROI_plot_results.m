function spm_ROI_plot_results(Plots)

opt = Plots.opt;

Plevels=[.05,.01,.001];% p threshold(s) for bar plots
Pcolors=['b','g','y','r'];% color(s) for bar plots
FIXEDRANDOM={'fixed','random'};

UserOption=opt{1};
idxRegions=opt{2};
Contrast=opt{3};
FixedRandom=FIXEDRANDOM{opt{4}};
Level2Contrast=opt{5};
Group=opt{6};

%%%%%%%%%%%%%%%%%%%%%%% PLOTS %%%%%%%%%%%%%%%%%%
for nplot2=1:size(Plots.F,2),
    for nplot3=1:size(Plots.F,3),
        figure('numbertitle','off','name',['spm_ROI results window'],'color',[.5,0,.5]);
        hd=subplot(131);%set(hd,'units','normalized','position',[.2,.6,.4,.3]);
        % Plots effects
        if UserOption==4 | UserOption==2, nplot2temp=nplot2; else, ...
		      nplot2temp=':'; end
        temp=squeeze(Plots.mean(:,nplot2temp,nplot3,:));
        bar(1:size(Plots.mean,1),temp(:,:)); 
        if UserOption==4,
            hold on;
            hd=errorbar(1:size(Plots.mean,1),Plots.mean(:,nplot2, ...
							nplot3), ...
			Plots.conf(:,nplot2,nplot3),'r.'); set(hd,'markersize',16,'linewidth',2);
            hold off;
            set(gca,'xlim',[0,size(Plots.mean,1)+1],'ylim', ...
		    max(abs(Plots.mean(:,nplot2,nplot3))+abs(Plots.conf(:,nplot2,nplot3)))*[-1.1,1.1]);
        else    
            set(gca,'xlim',[0,size(Plots.mean,1)+1],'ylim', ...
		    max(max(max(abs(Plots.mean(:,nplot2temp,nplot3,:)),[],1),[],2),[],4)*[-1.1,1.1]);
        end
        set(gca,'xtick',1:size(Plots.mean,1),'xticklabel',Plots.title{1}); ...
	    %,'xcolor','y','ycolor','y');
        hd=title('Effects'); set(hd,'fontsize',18,'fontweight','bold'); ...
	   %,'color','y');
        hd=ylabel('% Activation change'); set(hd,'fontsize',14, ...
						 'fontweight','bold'); ...
	%,'color','y');
        %%%if ~isempty(Plots.legend), temp={nplot2,nplot3};
        %temp=temp{Group}; legend(Plots.legend{temp}); end
        view([90,90]); grid on; 
        hd=subplot(132);%set(hd,'units','normalized','position',[.2,.1,.4,.3]);
        % Plots statistics
        Z=Plots.F(:,nplot2,nplot3); Pz=Plots.p(:,nplot2,nplot3); ...
	  x=1:length(Z);
        i2=bar(x,Z,Pcolors(1)); clim2=max(abs(Z(:)));
        nn=1; for n1=1:length(Plevels),
            idx=find(Pz<Plevels(n1));
            if isempty(idx), break; end
            Z(setdiff(x,idx))=0;
            hold on; bar(x,Z,Pcolors(1+n1)); hold off;
            nn=nn+1;
        end 
        set(gca,'xtick',1:size(Plots.F,1)); set(gca,'xticklabel',[]); ...
	    %,'xcolor','y','ycolor','y');
        hd=title('Statistics'); set(hd,'fontsize',18,'fontweight','bold'); ...
	   %,'color','y');
        hd=ylabel(Plots.xlabel); set(hd,'fontsize',14, ...
					'fontweight','bold');
                                                              %%,'color','y');
        view([90,90]); set(gca,'xlim',[0,size(Plots.F,1)+1],'ylim', ...
			       max(abs(Plots.F(:,nplot2,nplot3)))* ...
			       [-1.1,1.1]); grid on;
        
        hd=uicontrol('units','normalized','position',[.64,0,.36, ...
		    1],'style','frame','backgroundcolor',[.5,0,.5]);
        hd=uicontrol('units','normalized','position',[.65,.65,.35,.35],'style','text','horizontalalignment','left','fontweight','bold','backgroundcolor',[.5,0,.5],'foregroundcolor','y','string',...
            strvcat(...
            Plots.title0, ...
            Plots.title{3}{nplot3}, ...
            [FixedRandom,'-effect analysis'], ...
            Plots.title{2}{nplot2}));
        hd=uicontrol('units','normalized','position',[.65,.2,.35,.6],'style','listbox','horizontalalignment','left','string',...
            strvcat(...
            ['Name : ',Plots.xlabel,' : p'],...
            '_________________',...
            [strvcat(Plots.title{1}{:}),repmat(' : ',[size(Plots.F, ...
						  1),1]), ...
	     num2str(Plots.F(:,nplot2,nplot3),'%+8.4f'),repmat(' : ',[size(Plots.F,1),1]),num2str(Plots.p(:,nplot2,nplot3),'%5.4f')],...
            '' ...
            ));

        hd=uicontrol('units','normalized','position',[.7,.05,.25, ...
		    .1],'style','pushbutton','foregroundcolor', ...
		     'y','backgroundcolor',[.5 .5 0],'fontweight','bold',...
            'string',...
            'Plot spatial effects');
        Contrastplot={idxRegions, Contrast, Level2Contrast};
        if UserOption==1 | UserOption==3, Contrastindex={':',':', ...
		    nplot3};
        else, Contrastindex={':',nplot2,nplot3}; end
        Contrastindex={Contrastindex{[Group,setdiff(1:3,Group)]}};
        set(hd,'callback',...
            ['spm_ROI_plot_charact([', ...
                num2str(Contrastplot{1}(Contrastindex{1})'),...
                '],[',...
                num2str(Contrastplot{2}(Contrastindex{2})'),...
                '],[',...
                num2str(Contrastplot{3}(Contrastindex{3})'),...
                '],1);']);
    end
end

